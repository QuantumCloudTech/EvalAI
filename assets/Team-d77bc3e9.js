import{_ as x,b7 as H,b8 as K,u as L,al as $,r as R,aJ as j,o as u,c as p,a,t as d,as as o,Z as n,F as V,b as w,a7 as I,ba as J,a6 as g,a0 as Y,a3 as Z,ar as A,b9 as C,bb as G,p as O,d as Q}from"./index-f743b3f6.js";import{E as W}from"./el-dialog-d60669c6.js";import{E as X,n as ee}from"./el-form-item-f656376e.js";import{g as ae,E as te,u as se,e as le,o as oe,r as ne,l as ie,_ as de}from"./team-542549fd.js";import{E as M}from"./el-loading-7c6c347d.js";const r=b=>(O("data-v-3f716426"),b=b(),Q(),b),re={class:"flex-between mb24"},me={class:"title"},ce=r(()=>a("svg",{class:"icon mr8","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-chuangjian"})],-1)),ue={class:"content"},pe={class:"flex-between mb16",style:{height:"32px"}},_e={class:"second-title"},ve={class:"flex"},fe=["onClick"],ge=r(()=>a("svg",{class:"icon","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-bianji"})],-1)),be=[ge],he=["onClick"],ke=r(()=>a("svg",{class:"icon","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-yaoqing"})],-1)),ye=[ke],$e=["onClick"],Ve=r(()=>a("svg",{class:"icon","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-a-Logout"})],-1)),Ce=[Ve],Se={class:"mb16"},Te={class:"label mr8"},Ee={class:"member"},Ne={class:"label"},we={class:"con small-scrollbar"},Ie={key:0,class:"nodata"},Me=r(()=>a("img",{src:de,alt:""},null,-1)),ze=r(()=>a("span",null,"No team",-1)),Be=[Me,ze],Ue={class:"between"},Pe=r(()=>a("div",null,null,-1)),De={class:"between"},Fe=r(()=>a("div",null,null,-1)),qe={__name:"Team",setup(b){const{t:f}=H(),z=K();L();const t=$({visible:!1,name:"",url:"",id:""}),m=$({total:0,pageNum:1,pageSize:10}),h=R([]),_=()=>{const e=M.service();ae({page:m.pageNum}).then(s=>{h.value=s.results||[],m.total=s.count}).finally(s=>{e.close()})},B=()=>{t.name="",t.url="",t.id="",t.visible=!0},U=e=>{t.name=e.team_name,t.url=e.team_url,t.id=e.id,t.visible=!0},P=()=>{const e=M.service();(t.id?se(t.id,{team_name:t.name,team_url:t.url}):le({team_name:t.name,team_url:t.url})).then(c=>{C.success(f(t.id?"team.updateSuccess":"team.createSuccess")),t.visible=!1,_()}).catch(c=>{e.close()})},D=e=>{oe({title:f("team.removeYourself"),message:f("team.removeNote")}).then(()=>{ne(e.id).then(s=>{C.success(f("team.removeSuccess")),_()})}).catch(()=>{})},i=$({visible:!1,id:"",email:""}),F=e=>{i.visible=!0,i.id=e.id,i.email=""},S=()=>{ie(i.id,{email:i.email}).then(e=>{C.success(f("team.intiveSuccess")),i.visible=!1,_()})};return j(()=>{_()}),(e,s)=>{const c=J,q=te,k=G,y=X,T=ee,E=W;return u(),p(V,null,[a("div",re,[a("div",me,d(e.$t("team.team")),1),o(c,{type:"primary",onClick:B},{default:n(()=>[ce,g(" "+d(e.$t("team.createTeam")),1)]),_:1})]),a("div",ue,[(u(!0),p(V,null,w(h.value,l=>{var N;return u(),p("div",{class:"card",key:l},[a("div",pe,[a("div",_e,d(l.team_name),1),a("div",ve,[l.created_by===((N=Y(z).state.userInfo)==null?void 0:N.username)?(u(),p("span",{key:0,class:"icon-button mr8",onClick:v=>U(l)},be,8,fe)):I("",!0),a("span",{class:"icon-button mr8",onClick:v=>F(l)},ye,8,he),a("span",{class:"icon-button",onClick:v=>D(l)},Ce,8,$e)])]),a("div",Se,[a("span",Te,d(e.$t("team.createdBy"))+":",1),a("span",null,d(l.created_by),1)]),a("div",Ee,[a("div",Ne,d(e.$t("team.members"))+":",1),a("div",we,[(u(!0),p(V,null,w(l.members,v=>(u(),p("p",{key:v},d(v.member_name)+"（"+d(v.email)+"）",1))),128))])])])}),128))]),h.value.length===0?(u(),p("div",Ie,Be)):I("",!0),o(q,{"hide-on-single-page":"",background:"",layout:"prev, pager, next",total:m.total,"page-size":m.pageSize,"onUpdate:pageSize":s[0]||(s[0]=l=>m.pageSize=l),"current-page":m.pageNum,"onUpdate:currentPage":s[1]||(s[1]=l=>m.pageNum=l),onSizeChange:_,onCurrentChange:_,class:"mt24 oa-pagination"},null,8,["total","page-size","current-page"]),o(E,{modelValue:t.visible,"onUpdate:modelValue":s[5]||(s[5]=l=>t.visible=l),title:t.id?e.$t("team.editTeam"):e.$t("team.createTeam"),width:"500",class:"oa-dialog","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:n(()=>[a("div",Ue,[Pe,a("div",null,[o(c,{onClick:s[4]||(s[4]=l=>t.visible=!1),text:"",bg:""},{default:n(()=>[g(d(e.$t("cancel")),1)]),_:1}),o(c,{type:"primary",disabled:!t.name,onClick:P},{default:n(()=>[g(d(e.$t("save")),1)]),_:1},8,["disabled"])])])]),default:n(()=>[o(T,{model:t,ref:"teamRef","label-position":"top","require-asterisk-position":"right","show-message":!1},{default:n(()=>[o(y,{label:e.$t("team.teamName"),prop:"name",required:""},{default:n(()=>[o(k,{placeholder:e.$t("team.teamNamePH"),modelValue:t.name,"onUpdate:modelValue":s[2]||(s[2]=l=>t.name=l),modelModifiers:{trim:!0},maxlength:"100"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),o(y,{label:e.$t("team.url"),prop:"url"},{default:n(()=>[o(k,{placeholder:e.$t("team.urlPH"),modelValue:t.url,"onUpdate:modelValue":s[3]||(s[3]=l=>t.url=l),modelModifiers:{trim:!0},maxlength:"1000"},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),o(E,{modelValue:i.visible,"onUpdate:modelValue":s[9]||(s[9]=l=>i.visible=l),title:e.$t("team.intive"),width:"500",class:"oa-dialog","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:n(()=>[a("div",De,[Fe,a("div",null,[o(c,{onClick:s[8]||(s[8]=l=>i.visible=!1),text:"",bg:""},{default:n(()=>[g(d(e.$t("cancel")),1)]),_:1}),o(c,{type:"primary",disabled:!i.email,onClick:S},{default:n(()=>[g(d(e.$t("send")),1)]),_:1},8,["disabled"])])])]),default:n(()=>[o(T,{model:i,ref:"intiveRef","label-position":"top",onSubmit:s[7]||(s[7]=Z(()=>{},["prevent"]))},{default:n(()=>[o(y,{label:e.$t("team.email"),prop:"email"},{default:n(()=>[o(k,{modelValue:i.email,"onUpdate:modelValue":s[6]||(s[6]=l=>i.email=l),modelModifiers:{trim:!0},placeholder:e.$t("team.emailPH"),onKeypress:A(S,["enter"])},null,8,["modelValue","placeholder","onKeypress"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}},je=x(qe,[["__scopeId","data-v-3f716426"]]);export{je as default};
